package models|//Created by niaobi.org|

//Coin 对应coin表 
//角色发行的鸟币
//分为不变(coin表)和变化(如coinV表)的两部分
=Coin
-ID 0 				//鸟币ID
-RoleID 0 			//角色ID，必填
-UserID 0 			//用户ID，必填

-Alias 1 			//唯一鸟币名称，"xxx币"(不包括'币')，不可重复，不可更改，必填，5字内
-Symbol 1			//鸟币缩写，全英文，如 BTC、ETH，字母转换为大写，不可重复，不可更改，必填，5个字母内，'NB'为保留缩写
-CreatedAt 6 		//创建日期

//----鸟币的目前状态----
-Version 4 			//目前最新的发行版本号，默认为1。每次发行鸟币时，属性如有变动（包括技能规则修改、属性修改等），则版本号+1
-CashedNum 4 		//目前已兑现承诺的次数
-UncashedNum 4 		//目前未兑现承诺的次数
-Credit 3 			//目前鸟币信用，默认为0
-UpdatedAt 4 		//目前状态最后更新时间
//------------------------

//----超级鸟币的目前状态----
-CashedNumS 4 		//目前已兑现承诺的次数——单独的属性，因为超级鸟币不计入鸟币信用
-UncashedNumS 4 	//目前未兑现承诺的次数——单独的属性，因为超级鸟币不计入鸟币信用
//-----------------------

~//=====for client=====
~updateTimeAgo 1
~creditLevel 1


################################################

//CoinV 对应coinV表，V=Version。同一种鸟币的不同版本，和coin表是一对多关系，和技能的关系参考<发行和技能版本关系图>
//每次发行普通鸟币之前，都需要先用CoinV表备份鸟币当前状态。使用5星制展示普通鸟币的等级。
//新建coinV-->发行普通鸟币-->new coinV state赋予coin state now->发行成功后更新鸟币信用
=CoinV
-ID 0 
-CoinID 0 			//鸟币ID，必填

-IsSuper 2			//超级鸟币标识
-PlotID 0			//超级鸟币剧情ID
-SkillSetID 0		//技能组ID
//3大类交易行为：发行(可以是支付、赠送、出售)、转手(可以是支付、转赠、转卖)、兑现(包括兑现技能、提现现金、超级鸟币)，其中超级鸟币不支持出售、转卖和提现
//默认发行后即可'兑现技能'，默认占1星（鸟币等级一共5星）
//---以下属性在发行鸟币时（包括在转账页、赠送页、出售页等使用自己的鸟币）提供给用户自行选择---
-CanGift 2 			//是否可以'转赠'鸟币，默认true，占普通鸟币一颗星
-CanSell 2 			//是否可以'转卖'鸟币，默认true，占普通鸟币一颗星
-CanCash 2 			//是否可以'提现（RMB）'，默认true，占普通鸟币一颗星
-CanCashNow 2		//是否可以'立即提现（RMB）'，占普通鸟币一颗星
-CashDate 3			//可开始提现的日期
//------------------------------------------------------------------------------

//-------------鸟币当时的状态，和coin表一致-----------
-Version 4 			//目前最新的发行版本号，默认为1。每次发行鸟币时，属性如有变动（包括技能规则修改、属性修改等），则自增1
-CashedNum 4 		//目前已兑现承诺的次数
-UncashedNum 4 		//目前未兑现承诺的次数
-Credit 3 			//目前鸟币信用，默认为0
-UpdatedAt 4 		//目前状态最后更新时间
//------------------------

//----超级鸟币的目前状态----
-CashedNumS 4 		//目前已兑现承诺的次数
-UncashedNumS 4 	//目前未兑现承诺的次数
//-----------------------

-CreatedAt 6 		//创建时间

################################################

@//TransferLocks 交易锁
@//交易包括了转账CoinTransfer和兑现CoinCash
@=TransferLocks
@Locks map[string]bool -jb			 

@################################################


//CoinTransfer 对应coinT表，鸟币转账
=CoinTransfer
-ID 0
-FormUserID 0 			//转账方的UserID
-ToUserID 0 			//收款方UserID，用于查询某个用户的不同方式的转账总数

-FormRoleID 0 			//转账角色ID
-ReceiveType 4			//收款方式 4种：1.手机号 2.钱包地址（包括二维码） 3.角色名 4.用户名
-ToPhone 1 				//1.通过手机号来转账
-ToPhoneCC 1 			//1.手机号的Country Code
-ToWalletKey 1 			//2.收款方的鸟币钱包地址
-ToRoleName 1 			//3.通过唯一的角色名称来转账，转账必须先创建角色和鸟币
-ToUserName 1			//4.通过唯一的用户名来转账，用户名如果没有修改的话默认是手机号

-IsIssue 2				//是发行还是转手的标识
-IsSuperCoin 2			//是否是超级鸟币（超级鸟币不计入鸟币信用）
-ValidDays 4 			//超级鸟币的有效天数

//发行鸟币的时候进行选择鸟币版本。版本有3种，一种是未进行选择，默认选择所有技能；第二种是选择了鸟币技能组，每个技能有若干不同的技能；第三种是超级鸟币
-CoinID 0				//鸟币ID
-CoinVID 0 				//鸟币版本ID
-TransferNum 4 			//交易的鸟币数量

-TradeType 4 			//10种转账类型，——①技能合约  ——②剧情合约 ——③鸟币红包 ——④投资合约(有风险)  ——⑤对赌合约（能保底的投资） ——⑥转卖①|③  ——⑦赠送①|③   ——⑧转卖④|⑤  ——⑨赠送④|⑤ ——⑩赠送②
-CreatedAt 6 			//创建时间

################################################

//CoinCash 对应coinC表，兑现鸟币
=CoinCash
-ID 0				
-FromUserID 0 			//兑现者的UserID
-ToUserID 0 			//发行者UserID
-ToRoleID 0				//发行者的角色ID

-CoinID 0 				//鸟币ID
-CoinVID 0				//要'兑现'的鸟币版本ID（提现则可能有多个版本）
-CashNum 4				//兑现多少鸟币，超级鸟币默认为1个

-IsCashMoney 2			//是否是提现现金
-IsSuperCoin 2			//是否是超级鸟币（超级鸟币不计入鸟币信用）
-PlotID 0				//超级鸟币规则ID
-CashSkillID 0			//兑现的技能ID，可能用到多个版本的鸟币

//1.已发送兑现请求，等待对方确认/需要确认兑现请求 
//2.对方接受了兑现请求，鸟币已被回收(显示'未兑现'和'已兑现'按钮)/鸟币已成功回收，提示请自行完成兑现 
//3.对方拒绝了你的兑现请求(包括未及时处理系统自动拒绝)/您拒绝了兑现请求 
//4.兑现未执行(兑现者手动选择的状态，需要添加comment说明)/对方认为兑现失败 
//5.兑现已完成
//6.兑现失败（由于鸟币不足等原因）
-State 4				//兑现状态（兑现时需要发行者确认，默认24小时响应，超时自动视为拒绝)
-Comment 1 				//兑现者使用状态4的说明

-UpdatedAt 4			//更新时间
-CreatedAt 6 			//创建时间

################################################

@//CoinTTotal 对应coinTT表，t=type 当前拥有的同一种类型的鸟币总数
@//收入方 total+正，支出方 total+负
@=CoinTTotal
@ID 0
@OwnerID 0 			//持有者
@CoinID 0 			//鸟币类型
@IsSuper 2			//是否是超级鸟币（超级鸟币不计入鸟币信用）
@Total int64		//同一种类型的拥有总量

@CreatedAt 6 		//创建时间

@################################################

@//CoinVTotal 对应coinVT表，当前拥有的同一个版本的鸟币总数
@//收入方 total+正，支出方 total+负
@=CoinVTotal
@ID 0
@OwnerID 0 			//持有者
@CoinVID 0 			//鸟币版本
@Total int64		//同一个版本的拥有总量

@CreatedAt 6 		//创建时间

@################################################

